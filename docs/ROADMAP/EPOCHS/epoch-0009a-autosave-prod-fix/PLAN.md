# Epoch 0009a Autosave Production Hotfix

## Objective
Fix the issue where autosave works in preview environments but fails in Vercel production.  
The likely cause is that the service worker generated by next-pwa is affecting PUT requests to /api/intentions.  
This epoch delivers a contained and reversible fix.

## Scope
- Update next.config.mjs so the service worker does not handle or cache API routes.
- Ensure PUT requests to /api/intentions reach the server reliably in production.
- Validate the fix through production linked testing.
- Keep changes minimal and reversible.

## Out of Scope
- Autosave redesign.
- General PWA improvements.
- Broader refactors unrelated to the hotfix.

## Deliverables
- Patch to next.config.mjs excluding /api/** from Workbox.
- Confirmed autosave behaviour in production.
- Clean return to stable state after validation.

## Implementation Steps
1. Add instrumentation to autosave and the intentions API route to observe production behaviour.
2. Apply the Workbox exclusion for /api/** in next.config.mjs.
3. Deploy and validate autosave in production.
4. Remove instrumentation once autosave is confirmed working.
5. Close the epoch.

## Risks
- If autosave fails for a reason other than the service worker, further debugging will be required.
- Excluding API routes reduces offline capability but is acceptable for a hotfix.
