---
id: prompt-0124
epoch: 0010-prompt-refinement
issued_at: 2025-11-21T18:09:34Z
accepted_at: 2025-11-21T18:09:40Z
completed_at: 2025-11-21T18:09:40Z
status: completed
branch: work
pr: 26
validation_checks:
  - command: |
      python - <<'PY'
      import json
      import pathlib
      import yaml
      from jsonschema import validate

      schema = json.loads(pathlib.Path('docs/SCHEMA/pr-log.schema.json').read_text())
      pr_log = yaml.safe_load(pathlib.Path('docs/LOGS/PRS/pr-0026-pr-1d-hotfix-llm-instrumentation.md').read_text())

      validate(instance=pr_log, schema=schema)
      print('PR log passes schema validation.')
      PY
    outcome: passed
    notes: Validated PR log against pr-log.schema.json using jsonschema.
  - command: |
      python - <<'PY'
      import json
      import pathlib
      import yaml
      from jsonschema import validate, ValidationError

      path = pathlib.Path('docs/LOGS/PROMPTS/2025-11-21T18:09:34Z-prompt-0124.md')
      text = path.read_text()
      _, front_matter_text, _ = text.split('---', 2)
      front_matter = yaml.safe_load(front_matter_text)

      schema = json.loads(pathlib.Path('docs/SCHEMA/prompt.schema.json').read_text())
      try:
        validate(instance=front_matter, schema=schema)
        print('Prompt log passes prompt schema validation.')
      except ValidationError as e:
        print(f'Prompt log failed prompt schema validation: {e.message}')
      PY
    outcome: failed
    notes: Prompt log format omits required prompt.schema.json fields such as `by` and `intent`.
---

Add LLM instrumentation to all AI entrypoints and remove client env usage.

## Notes
- Follow-up actions:
  - Align prompt log structure with prompt.schema.json if required in future work.

## Validation
- command: |
    python - <<'PY'
    import json
    import pathlib
    import yaml
    from jsonschema import validate

    schema = json.loads(pathlib.Path('docs/SCHEMA/pr-log.schema.json').read_text())
    pr_log = yaml.safe_load(pathlib.Path('docs/LOGS/PRS/pr-0026-pr-1d-hotfix-llm-instrumentation.md').read_text())

    validate(instance=pr_log, schema=schema)
    print('PR log passes schema validation.')
    PY
  outcome: passed
  notes: Validated PR log against pr-log.schema.json using jsonschema.
- command: |
    python - <<'PY'
    import json
    import pathlib
    import yaml
    from jsonschema import validate, ValidationError

    path = pathlib.Path('docs/LOGS/PROMPTS/2025-11-21T18:09:34Z-prompt-0124.md')
    text = path.read_text()
    _, front_matter_text, _ = text.split('---', 2)
    front_matter = yaml.safe_load(front_matter_text)

    schema = json.loads(pathlib.Path('docs/SCHEMA/prompt.schema.json').read_text())
    try:
      validate(instance=front_matter, schema=schema)
      print('Prompt log passes prompt schema validation.')
    except ValidationError as e:
      print(f'Prompt log failed prompt schema validation: {e.message}')
    PY
  outcome: failed
  notes: Prompt log format omits required prompt.schema.json fields such as `by` and `intent`.
