---
id: prompt-0121
epoch: epoch-0010-prompt-refinement
issued_at: 2025-11-21T11:26:48Z
by: backend-ai
intent: Add instrumentation for AI model visibility on suggest-steps routes and client setup.
context: "User requested PR 1 Hotfix to emit active model and prompt details during epoch 0010."
inputs:
  - type: request
    value: Add debugSink pushes for active LLM and prompt capture.
plan:
  - step: Review suggest-steps handlers and AI client for instrumentation points.
    owner: backend
  - step: Add debugSink pushes for model selection and prompt payloads without changing logic.
    owner: backend
  - step: Update logs and validate schema compliance.
    owner: backend
success_criteria:
  - Active model is logged for suggest-steps and AI client creation.
  - Step generation prompt is captured in debug sink.
  - No functional changes beyond instrumentation.
risks: []
follow_ups: []
links:
  frontend_log: docs/LOGS/FRONTEND/prompt-0121.md
  related_prompts: []
  assets: []
  roadmap_items: []
---

Added instrumentation to emit active model and prompt details for AI suggest-steps and client flows.

## Lifecycle
- accepted_at: 2025-11-21T11:25:47Z
- completed_at: 2025-11-21T11:27:24Z
- status: completed
- branch: work
- pr: 23

## Notes
- Follow-up actions:
  - None

## Validation
- command: npm run lint
  outcome: passed
  notes: Next.js lint completed (TypeScript support warning only).
- command: |
    python - <<'PY'
    import json
    import pathlib

    import yaml
    from jsonschema import validate

    schema = json.loads(pathlib.Path('docs/SCHEMA/prompt.schema.json').read_text())
    raw = pathlib.Path('docs/LOGS/PROMPTS/2025-11-21T11:26:48Z-prompt-0121.md').read_text()
    frontmatter = raw.split('---', 2)[1] if raw.startswith('---') and raw.count('---') >= 2 else raw
    prompt_log = yaml.load(frontmatter, Loader=yaml.BaseLoader)

    validate(instance=prompt_log, schema=schema)
    print('Prompt log passes schema validation.')
    PY
  outcome: passed
  notes: Validated prompt log against prompt schema.
- command: |
    python - <<'PY'
    import json
    import pathlib

    import yaml
    from jsonschema import validate

    schema = json.loads(pathlib.Path('docs/SCHEMA/pr-log.schema.json').read_text())
    pr_log = yaml.load(pathlib.Path('docs/LOGS/PRS/pr-0023-epoch-0010-ai-model-instrumentation.md').read_text(), Loader=yaml.BaseLoader)
    pr_log['number'] = int(pr_log.get('number')) if 'number' in pr_log else None

    validate(instance=pr_log, schema=schema)
    print('PR log passes schema validation.')
    PY
  outcome: passed
  notes: Validated PR log against PR schema.
