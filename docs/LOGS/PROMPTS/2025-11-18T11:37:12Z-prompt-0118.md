---
id: prompt-0118
epoch: 0009-real-edge-integration
issued_at: 2025-11-18T11:37:12Z
accepted_at: 2025-11-18T11:37:20Z
completed_at: 2025-11-18T11:45:00Z
status: completed
branch: work
pr:
validation_checks:
  - command: npm run lint
    outcome: pass
    notes: "Ensures middleware + hook tweaks stay lint-clean"
---

## Summary
- Updated the autosave fetcher to always include credentials so production requests carry the signed NextAuth session cookie.
- Replaced the redirecting NextAuth middleware with a JSON 401 guard driven by `getToken`, avoiding HTML redirects that broke the autosave error parser.

## Notes
- Follow-up actions:
  - Monitor production autosave to confirm authenticated saves now succeed and unauthenticated clients see the JSON error banner.

## Validation
- command: npm run lint
  outcome: pass
  notes: "Matches validation_checks"
