---
id: prompt-0104
epoch: 0008
issued_at: 2025-11-15T17:07:34Z
accepted_at: 2025-11-15T17:08:00Z
completed_at: 2025-11-15T17:20:00Z
status: completed
branch: feature/epoch-0008/opportunity-ai-simulation
pr: 
validation_checks: []
---

Use backend ids for opportunities hook

## Notes
- Step cards now prefer `step._id` for opportunity lookups and fall back to the client id when needed.
- Added regression coverage for the step normaliser and the cardâ€™s hook invocation guard.
- Follow-up actions:
  - None.

## Validation
- command: npm test -- --runTestsByPath test/ui/StepCard.test.tsx test/components/Canvas/normaliseStepFromApi.test.ts test/hooks/useOpportunities.test.tsx
  outcome: passed
  notes: ""
